<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="dblodgett@usgs.gov" />


<title>Working with NHDPlusHR</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Working with NHDPlusHR</h1>
<h4 class="author"><a href="mailto:dblodgett@usgs.gov" class="email">dblodgett@usgs.gov</a></h4>



<div id="tldr" class="section level2">
<h2>TL;DR;</h2>
<p>Most functions in <code>nhdplusTools</code> work with NHDPlus High
Res (HR) the same as they do with medium res. The demo below shows how
to get a single four-digit hydrologic unit worth of HR data, index a
point to it, subset it, and plot the results.</p>
<p><em>Note: For consistency, identifiers from NHDPlusV2 are used with
HiRes data. A future release of nhdplusTools may alter this
behavior.</em></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(nhdplusTools)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>work_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">nhdplusTools_data_dir</span>(), <span class="st">&quot;hr_v_cache&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/sample_data.R&quot;</span>, <span class="at">package =</span> <span class="st">&quot;nhdplusTools&quot;</span>))</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>hr_gpkg <span class="ot">&lt;-</span> <span class="fu">file.path</span>(work_dir, <span class="st">&quot;hr_data.gpkg&quot;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># Make a plot and get some background NHDPlusV2 data.</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">plot_nhdplus</span>(<span class="fu">list</span>(<span class="st">&quot;nwissite&quot;</span>, <span class="st">&quot;USGS-05428500&quot;</span>), <span class="at">streamorder =</span> <span class="dv">3</span>,</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>                          <span class="at">nhdplus_data =</span> sample_data)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAABlBMVEX7+/v///+0D4btAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADs0lEQVR4nO3SoQ3AMBDAwO/+SweGBFQxqCrdTWDgeSCYrwP4NwORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5HsgQbeMhCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSE4DwQUDkRiIxEAkBiIxEImBSAxEYiASA5EsI16P0jsU9O0AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Find the HU04 we are interested in.</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>hu04 <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">substr</span>(plot_data<span class="sc">$</span>flowline<span class="sc">$</span>reachcode, <span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Download some NHDPlusHR Data</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>hr_data_dir <span class="ot">&lt;-</span> <span class="fu">download_nhdplushr</span>(work_dir, hu04)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># Projection and simplification for demo purposes.</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>hr <span class="ot">&lt;-</span> <span class="fu">get_nhdplushr</span>(work_dir, <span class="at">out_gpkg =</span> hr_gpkg,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>                    <span class="at">proj =</span> <span class="dv">3857</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>(start_index <span class="ot">&lt;-</span> <span class="fu">get_flowline_index</span>(<span class="fu">st_transform</span>(hr<span class="sc">$</span>NHDFlowline, <span class="dv">5070</span>),</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>                                   <span class="fu">st_transform</span>(plot_data<span class="sc">$</span>outlets, <span class="dv">5070</span>),</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>                                   <span class="at">search_radius =</span> <span class="dv">200</span>)) <span class="co"># meters albers eq area</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; defaulting to comid rather than permanent_identifier</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; Warning in check_search_radius(search_radius, points): search_radius units not</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; set, trying units of points CRS.</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; Warning in force_linestring(x): converting to LINESTRING, this may be slow,</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; check results</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;   id          COMID      REACHCODE REACH_meas   offset</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; 1  1 22001000032700 07090002006114    37.6572 87.71874</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">get_UT</span>(hr<span class="sc">$</span>NHDFlowline, start_index<span class="sc">$</span>COMID)</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; defaulting to comid rather than permanent_identifier</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>hr_subset <span class="ot">&lt;-</span> <span class="fu">subset_nhdplus</span>(ids, <span class="at">nhdplus_data =</span> hr_gpkg)</span></code></pre></div>
<p>Now that we have both a four digit hydrologic unit worth of NHDPlusHR
data and a subset upstream of a point of interest, we can plot things up
and see what it looks like. This plot uses NHDPlusV2 as returned by
<code>plot_nhdplus()</code> as a base layer and adds NHDPlusHR data on
top of it.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">plot_nhdplus</span>(<span class="fu">list</span>(<span class="st">&quot;nwissite&quot;</span>, <span class="st">&quot;USGS-05428500&quot;</span>), <span class="at">streamorder =</span> <span class="dv">2</span>, </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>             <span class="at">nhdplus_data =</span> sample_data, <span class="at">overwrite =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>             <span class="at">plot_config =</span> <span class="fu">list</span>(<span class="at">flowline =</span> <span class="fu">list</span>(<span class="at">lwd =</span> <span class="fl">2.5</span>),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                                <span class="at">basin =</span> <span class="fu">list</span>(<span class="at">lwd =</span> <span class="dv">3</span>)))</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(hr<span class="sc">$</span>NHDPlusCatchment), <span class="at">lwd =</span> <span class="fl">0.25</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(hr<span class="sc">$</span>NHDFlowline), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(<span class="fu">st_transform</span>(hr_subset<span class="sc">$</span>NHDFlowline, <span class="dv">3857</span>)),</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;cyan&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAABlBMVEX7+/v///+0D4btAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADs0lEQVR4nO3SoQ3AMBDAwO/+SweGBFQxqCrdTWDgeSCYrwP4NwORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5HsgQbeMhCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSAxEYiASA5EYiMRAJAYiMRCJgUgMRGIgEgORGIjEQCQGIjEQiYFIDERiIBIDkRiIxEAkBiIxEImBSE4DwQUDkRiIxEAkBiIxEImBSAxEYiASA5EsI16P0jsU9O0AAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="download" class="section level2">
<h2>Download</h2>
<p>NHDPlusHR support in nhdplusTools begins with the function
<code>download_nhdplushr()</code>. The NHDPlusHR can be downloaded in <a href="https://www.usgs.gov/national-hydrography/access-national-hydrography-products">four
digit hydrologic unit code subsets here.</a>
<code>download_nhdplushr()</code> facilitates downloading these subsets
for as few or as many as you need. It takes a directory you want to save
your output into and a vector of four digit (HU04) or two digit (HU02)
hydrologic units. There is also an option to just return the URLs of the
data that would be downloaded for you to use in some other process.
Since the TL;DR; above already downloaded some data. The code below
shows how to just get the URLs for a whole HU02 and what the output
looks like on disk.</p>
<p><em>Note: Data for each HU02 are put in their own output
folder.</em></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>(hr_urls <span class="ot">&lt;-</span> <span class="fu">download_nhdplushr</span>(work_dir, <span class="st">&quot;06&quot;</span>, <span class="at">download_files =</span> <span class="cn">FALSE</span>))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;https://prd-tnm.s3.amazonaws.com/StagedProducts/Hydrography/NHDPlusHR/VPU/Current/GDB/NHDPLUS_H_0601_HU4_20220418_GDB.zip&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; [2] &quot;https://prd-tnm.s3.amazonaws.com/StagedProducts/Hydrography/NHDPlusHR/VPU/Current/GDB/NHDPLUS_H_0602_HU4_20220418_GDB.zip&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; [3] &quot;https://prd-tnm.s3.amazonaws.com/StagedProducts/Hydrography/NHDPlusHR/VPU/Current/GDB/NHDPLUS_H_0603_HU4_20220418_GDB.zip&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; [4] &quot;https://prd-tnm.s3.amazonaws.com/StagedProducts/Hydrography/NHDPlusHR/VPU/Current/GDB/NHDPLUS_H_0604_HU4_20220418_GDB.zip&quot;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co"># already downloaded:</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="fu">list.files</span>(hr_data_dir)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;NHDPLUS_H_0709_HU4_GDB.gdb&quot; &quot;NHDPLUS_H_0709_HU4_GDB.jpg&quot;</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; [3] &quot;NHDPLUS_H_0709_HU4_GDB.xml&quot;</span></span></code></pre></div>
</div>
<div id="basic-functionality" class="section level2">
<h2>Basic functionality</h2>
<p>The second part of nhdplusTools support for NHDPlusHR is a bit more
involved. The entry point is a function called
<code>get_nhdplushr()</code>. At it’s core, it will take a collection of
NHDPlusHR subsets, open them up one by one and build a single output
table for later use. It also 1. joins flowline attributes to the
flowline geometry, 1. can return one or more selected layers, 1. can
save the result to a standalone geopackage for later use, and 1. can
make some attributes of a subset look like they are part of a standalone
network rather than having references to downstream data that aren’t in
the subset.</p>
<p>Using the data we downloaded in the TL;DR; intro, the code below
demonstrates a few behaviors of <code>get_nhdplushr()</code></p>
<p>First, if we just give it a directory containing HR data, it will
give us back a list with flowlines and catchments as sf data.frames.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>hr <span class="ot">&lt;-</span> <span class="fu">get_nhdplushr</span>(hr_data_dir)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">sapply</span>(hr, class)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;      NHDFlowline  NHDPlusCatchment</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; [1,] &quot;sf&quot;         &quot;sf&quot;            </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; [2,] &quot;tbl_df&quot;     &quot;tbl_df&quot;        </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; [3,] &quot;tbl&quot;        &quot;tbl&quot;           </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; [4,] &quot;data.frame&quot; &quot;data.frame&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(hr<span class="sc">$</span>NHDFlowline), <span class="at">lwd =</span> (hr<span class="sc">$</span>NHDFlowline<span class="sc">$</span>StreamOrde <span class="sc">/</span> <span class="dv">6</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>If we want more data, we can get any of the layer options listed in
the <code>get_nhdplushr()</code> documentation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>hr <span class="ot">&lt;-</span> <span class="fu">get_nhdplushr</span>(hr_data_dir, <span class="at">layers =</span> <span class="fu">c</span>(<span class="st">&quot;NHDFlowline&quot;</span>, <span class="st">&quot;NHDWaterbody&quot;</span>, <span class="st">&quot;NHDArea&quot;</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">sapply</span>(hr, class)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt;      NHDFlowline  NHDWaterbody NHDArea     </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; [1,] &quot;sf&quot;         &quot;sf&quot;         &quot;sf&quot;        </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; [2,] &quot;tbl_df&quot;     &quot;tbl_df&quot;     &quot;tbl_df&quot;    </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; [3,] &quot;tbl&quot;        &quot;tbl&quot;        &quot;tbl&quot;       </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; [4,] &quot;data.frame&quot; &quot;data.frame&quot; &quot;data.frame&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">sapply</span>(hr, nrow)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;  NHDFlowline NHDWaterbody      NHDArea </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;        34532        11444          499</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(hr<span class="sc">$</span>NHDFlowline), <span class="at">lwd =</span> (hr<span class="sc">$</span>NHDFlowline<span class="sc">$</span>StreamOrde <span class="sc">/</span> <span class="dv">6</span>), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="fu">st_geometry</span>(hr<span class="sc">$</span>NHDWaterbody), <span class="fu">st_geometry</span>(hr<span class="sc">$</span>NHDArea)), </span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;cyan&quot;</span>, <span class="at">border =</span> <span class="st">&quot;cyan&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.25</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Since this function can work over large amounts of data and we don’t
want to keep running it again and again, there is an option to save the
results to a standalone database for later use.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>demo_gpkg <span class="ot">&lt;-</span> <span class="fu">file.path</span>(work_dir, <span class="st">&quot;demo.gpkg&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>hr <span class="ot">&lt;-</span> <span class="fu">get_nhdplushr</span>(hr_data_dir, <span class="at">out_gpkg =</span> demo_gpkg)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">st_layers</span>(demo_gpkg)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; Driver: GPKG </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; Available layers:</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;         layer_name     geometry_type features fields crs_name</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 1      NHDFlowline Multi Line String    34532     57    NAD83</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 2 NHDPlusCatchment     Multi Polygon    42300      7    NAD83</span></span></code></pre></div>
</div>
<div id="hr-modification-and-filtering" class="section level2">
<h2>HR modification and filtering</h2>
<p>Since NHDPlusHR data can be very large, <code>get_nhdplushr()</code>
offers the ability to subset the data using a few filter options. Most
of the filters are described in the manual page of the
<code>get_hr_data()</code> utility function. 1.
<code>min_size_sqkm</code> will remove flowlines under a certain size
threshold. 1. <code>sim</code> will simplify all geometry to a given
tolerance using <code>sf::st_simplify()</code>. 1. <code>proj</code>
will project the output into the desired projection. 1.
<code>keep_cols</code> is used to specify which attributes are desired
in the output. 1. <code>rename</code> controls whether output is
automatically renamed to be compatible with <code>nhdplusTools</code>
functions.</p>
<p><em>Note: These options only operate on the flowline
network.</em></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">get_nhdplushr</span>(hr_data_dir, <span class="at">layers =</span> <span class="st">&quot;NHDFlowline&quot;</span>, </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                               <span class="at">min_size_sqkm =</span> <span class="dv">50</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(demo<span class="sc">$</span>NHDFlowline), </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>     <span class="at">lwd =</span> demo<span class="sc">$</span>NHDFlowline<span class="sc">$</span>StreamOrde<span class="sc">/</span><span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAABlBMVEUAAP////973JksAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAP+klEQVR4nO2dgXLjKgxF4f9/+s1rDEgCp2mV2NvLObOb1o7TidgzQgKnWypAgnL3G4C/DQJBCgSCFAgEKRAIUiAQpEAgSIFAkAKBIAUCQQoEghQIBCkQCFIgEKRAIEiBQJACgSAFAkEKBIIUCAQpEAhSIBCkQCBIgUCQAoEgBQJBCgSCFAgEKRAIUiAQpEAgSIFAkAKBIAUCQQoEghQIBCkQCFIgEKRAIEiBQJACgSAFAkEKBIIUCAQpEAhSIBCkQCBIgUCQAoEgBQJBCgSCFAgEKRAIUiAQpEAgSIFAkAKBIAUCQQoEghQIBCkQCFIgEKRAIEiBQJACgSAFAkEKBIIUCAQpEAhSIBCkQCBIgUCQAoEgBQJBCgSCFAgEKRAIUiAQpEAgSIFAkAKBIAUCQQoEghQIBCkQCFIg0GcojbvfyKeRD/AmHuZsYJB6fHeDQJBCfnzlA7wZ+fGVD/BmmMIgh/oAq8d3NY/W/f9RLcfx48uNb+mz6EZ2E8UsAfUuXnhFSDSsf4FgjehIi4b1r4BAkMLkINGRFg3rHlaFzhCoSA62Yky3URabX8U+e/H7uQLFmO7i2EANJ83TioOtGNM9lLYBH05PV2ghGNKtBEeOaauvBl3/hj6NYEi3EiR5HLZzCARPeZTQrmz+OtE0UkxBehHdiJuwxpZG292oirOYWjw3cmQbt4HatlbNrtiN7/ATqMVzG73Oqeu1H9UySC2eu7B1chnSlKktUxtwtXhuwvdZIxuVaYTVDBIL5zb8nRtWJwSCbwmfISyujI7XXve2rkAsnFtoiz3tqLfzy0VEsRSkFc0dhAa9Lfy4esjV0lpDrhXN1ZQ5s7TVZ9u4l2WFpIFUMFfjKp++7XVkoPanTM281JhLBXM1ru4xljRliuW2d/lZVOO6kC6Imc3GR8NKSFS1ag26UiyXE9JL34r3ny2sdprzxwIoxXIXYyKznyS0z9sOTWw2kwrmavp++3F4VNA1JJkxx13+Dj+PYkyXUaa90lrtGmI7bPOavVtIBbFwrqTnm5Bu+mNpt3PYzVWtCQyBfs2YuhYdVluNbvchLl6lglg41xFbK3cQFn/cNkYonP46KnFcjdt7t+fNmbBIXVdG/XmEQrmAZdoJN3Ks5rZYKglV0xpRXEbcU48ftXDdevGvKy4RqUxiGlFchc8p7SMXdhOjP0xXx5lNZORFwriIkTl6i+Xd8HNTCbnIXKqSgBDoR/Sbxcx81J4ZOxl2a8N+N3p6FXsqAv0GswDtqp/xSeZwWbE3lfmFoT+PUCifZywoz2XOIYbJL6XnIK+Z0CJQRaAfMSakccovQ5uF50c/FgUKL//7KMXyccI6oG/AHgfFne87YvYHaA25VjSfxjXix5KPTS/mPjJTMJu7W2sw7u+jFc2naRqMew+rbdbt3WQ2F/Ub7dtLhBAL5zJMNokV9ej1R8dvG/rL3+tHEQvnOuw8ZSubY3Xal9O+V5NCLqCLsOtAbVobk5oXaLxILv8g0G8prqKxLXs9Gq95uVFQHwR6hVY5x7O1jvqn19VGoFhdS461ZFDvwa7+lTl9zEuE/d4Ou83azmjmHwQ6JxYxs0BmidAcxJt9xjLQZ9/vTWhG9Q5Kn4zsCX/FyDHFPx9mL1l9EOicVrY8acH91obf1OhfdZPPF8KhvcQwJP4ztxLH74T6S/x/hRFf3VoxZX/2FqjYX6Maf4nP2Ipwp+JPKOMxvLro21N3F8hkoFD7mh6rPDPIZB9fAy1XEgXRj/AJTiDzWH0Ptvqgjv0ZdSVQyF5Vdag1o3oNs5M1FcKu+jEGmTM2PR0CFf/kujHTQjOq1yiLmwaNKvFWsdbWjwarOoGq1WZavRb1Z2uB7AKOyzbNgOlau3bYKqT2ZDswu2TmDmhVf7YXqD0Wl3HMLT2uAgptvS2Te9/uJ0HtZei6u0Aj+ZTq047LH9aJ6JmrjpwppsMXRjy872ibnKNrGnXMon0vYWmw9JxT/MuPZ31OkkQ6uBc4soQppUvPJS7VtMtDuVxsXioLgdQHWD2+7+jTjFl5DrNRWBIyJ33Hvt5RVR9g9fi+oxc65l/fNVbVZRJfI5vvSpmuaHOYNurxfUvpCpk0056ptjoa5+xV40f0Q/MT9AdYPb6XCIs1vsDxvzJhlYJCpVN87hJngxBfwSwE2mTTFpPNk8vNeTeKoZEXZ4MQX8LOYa4Pcz1WPdFmOYri/fvBDjGeY9eYTcFiyiK7QOgmuLCieNEb/vfYN/Ivjnlq3rHq/pgmPegV6p7L3vO/xa5xd0b/3R/a+ehFieoUc2ZtkP7w6kf4KkEgu2fhzbE9epwCw3BukJf0I3wVUy0fx3Fbwvdh80dV59HcYHQ3CPFV+kTkl4PcFebLVPaUKN0Wo7tBiK8zT1nBh1Fql1JKTFLLV1zwtm9FPsBXsFVxP+HbLtvD26r5tG+LP1oV9fheY9Gs2+1Rt+neFoWGXfZHmDNmUnT3UmuhGdWPaZnF7Zb6r2N6qyMj9deG/q29sskWpzYdRMP6MbFJryYtuWvcFn0/v2jAeqKSdecL5dh+RRTIzG61f1eKa9p9RnI/Rzj3PJAO7lfYEmY8uBxT3P1nx4tWmWoDNgnzB9iJqs9rft3wWcNlXnvZW76TPaL8AW19x63qBIHMfqpr29zqIgLtRrEZx7Xq1f3O1ePaWv1Jr882I7tJmC/iqppqZqW4kGPyjnmBHcxNEhACndHmrlVNY4tkm4Kif/55TcTD+z2tSg4fJTy+9/XROO1fXvX9QaAzhkDjsD3VF5d7i99O15aIJr1UkQ/wt4R7NsyXadOrjKORm5pe173je5AP8JfEEsdJEq4y+6XTcMqPr3yAvyR2WUag+YNfJaq10WqQeny/pYRvVvWNuZWjbY/FChuBdiWkELsi3Q7NWrStfGq1W/DyHskG9gZaenGVkNkmqyPfuHXsapozBNqVkUVK0CDIMOoet4EWujfZcZYNLIuZi0apY7+0yxYCfR32Z8vqfjMZZAPLYrbBis88dm6y1fIiMXUJdcdZNrAUYefLbX51LaqzJn7X57HHX9lxlg0sRYnTlN+JH7sZ/qx9aa+hVnWTELKBpYh3ZnifRifmrzG3l5Vxq9DIV5LoRpZjffOPPZxP2oLaZiLpURYOLcdyfupPTb/OJV7ut0KER1k4tCz+DiD7fQlV0eJivysmPMrCoaWZCunWj9Xo06IJ8z9DVyPJoN7EaZUTu3ff5E9bGGOf9dPv+AYUY3ob1opjI/5xNF3hFqTHJb0RK+EqHfQieifudg2jzdmFtbZPABW/ORZ2Q4SQC+i9mN12f/b4Jp5wtZK5bnlvtQRyAb2ZVjGvu3a/PeYuO1nMlktBavG8nXXmCGXxlJKOk86nRfMvgFxA78ZsSNizPi/5DTC7pDj9IDU0o3onZp3Ht/W1t+xjfgprQn4F8op3ezmaUb2X2KIfB4+/doFx9fvqVzd8KCEZ1HuJhUw78I16y1Tzq02HL4hkUO8llj+9Xi4++6wudqckU5BiTG+mb1bENcH+61pN4YNAMONSjC+Zezd/vtS8WCQSQjGmt+N/QVnzxghUF2uK49XSBgmG9CHmleW24eV7fHv6qKtHxrr8XX8cwZDeh1cmPNdnr2L+Y97jGdObmY0wyc9mCIb0PszKzrQgOIrmeIVbNrIpSBLdyN6AtSP2UlP5XCeBjD26w6wb2RsoI93M/iwF8ouJh0BVtf75H9Gw3sMQyJyzAsUd1dGU9WslCx+DdnQ5WjYpdtZy7XqXqaejxVfZ5POFcmxZDkXWPsytu6me3Qu0B1k5tizhPzzw3VZIK08Fogbaj74aaNLMeKZOSniBxiW2Q5Mca8mg8vS147mS6SvNziBXBLWX12FdraJjLRlUnrH3YHKIv5Gj+oXGx2Pxr/fJSHKsJYPKMyUgk05WG6uxMirhQVOe/5ENLIdptGzT1ZQIG6vjsc5XP8yTHWfZwFLYrtzeRdZO+4Ti14fcWf9yRWQDS+F6qmrXe+by+VSgx1/1AVaP73e49t26tM4nriryP0I39Ryox/dLivundyXzSiG72WrPCE9dDfkAf4cTyGWXuGFa3YKhX/jZgW0C/SEuydilRC+QvbXVXrvPuG4T6M8IVXJPMmbdJ0xifiT1p67GNoH+iNhlzZtbTxybnpNmn0h/QswuX4+xdvab7eOaikCbs1rmOV3/cd+cHCuzUagvE/LMaNxjF7++NWgrfxBohVuEtv7U/hB3u05erc9WwT5nXR/HxcNy3MMRLjbT215Dule0zxlTkz0Tfn1LODabG3sO5Z5Rn1KCLG3qGjVQv7B/Nd9uyJZBn2FLmqFSLJ3HpaE123Istwz6DCOQUcZI1K5zq9FkIDgYd3G04qc+TnhVwmbG2WrQHmwZ9BmtN3ezVZy7Qt6xJfcV7/FfY8ugT1gvOS/areBUvHIrtgz6BFf8RG9iAXT2+t3YMug1Y43Zl841bJaeG7QjjEUj3INq3Smueq6juAZGoWNNqW6rfVE3k4cajEJcd24nTe0T+vVqXdodBmJ5v5jbslgsREODQYnFT+13bjyOnvVdgEA1GlPd50njcxBgbGr1vy6hVT3FHtiLGTILo1Fr9e1X9ZWP2/qiEoowHLW6za9x72qrf1p/Tx29YvcRWe5THOuE/R4yxDln85GJDfpYMCxlNGD4c87eQxNnpbIQaINf0ZJht7Ep47HYCcvJZOrnthaNRCfsNi5l/O+DVhG74TVRW0EEM7sNy9KPh0o930w78vsN0+tsNzLr1DJEigYdX+96u/88O46MKXxqW+M5Hk0eak9X/HnGjkPjquJWFPWG3SlEF/8dO46Nv6HwkXbGM2UulG56n3+CLQfHzkvFCjS6fNfH3/Im/wg7Do4vbGaBbHPGFPYNW42Nm5LOM5C94qit4YytBsff2zNWeIYxcXKrrCF+w1Zj44J19yD6xsx/oQh6xlZjU84Pniz+kIKesdXQzBvvT67r5TP78c9gZBb0TXpXGsEKhmZFXELEoFMYmROK04bbWs9gVF4Cfc5gXCAFAkEKBIIUCAQpEAhSIBCkQCBIgUCQAoEgBQJBCgSCFAgEKRAIUiAQpEAgSIFAkAKBIAUCQQoEghQIBCkQCFIgEKRAIEiBQJACgSAFAkEKBIIUCAQpEAhSIBCkQCBIgUCQAoEgBQJBCgSCFAgEKRAIUiAQpEAgSIFAkAKBIAUCQQoEghQIBCkQCFIgEKRAIEiBQJACgSAFAkEKBIIUCAQpEAhSIBCkQCBIgUCQAoEgBQJBCgSCFAgEKRAIUiAQpEAgSIFAkAKBIAUCQQoEghQIBCkQCFIgEKRAIEiBQJACgSAFAkEKBIIUCAQpEAhSIBCkQCBIgUCQAoEgBQJBCgSCFAgEKRAIUiAQpEAgSIFAkAKBIAUCQQoEghQIBCkQCFIgEKRAIEiBQJACgSAFAkEKBIIUCAQpEAhSIBCkQCBIgUCQAoEgxX8fv05jIH73oAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">get_nhdplushr</span>(hr_data_dir, <span class="at">layers =</span> <span class="st">&quot;NHDFlowline&quot;</span>, </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                      <span class="at">min_size_sqkm =</span> <span class="dv">100</span>, </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                      <span class="at">proj =</span> <span class="st">&quot;+init=epsg:5070&quot;</span>, <span class="at">simp =</span> <span class="dv">200</span>,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                      <span class="at">keep_cols =</span> <span class="fu">c</span>(<span class="st">&quot;COMID&quot;</span>, <span class="st">&quot;StreamOrde&quot;</span>))</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; Warning in CPL_crs_from_input(x): GDAL Message 1: +init=epsg:XXXX syntax is</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; deprecated. It might return a CRS with a non-EPSG compliant axis order. Further</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; messages of this type will be suppressed.</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="fu">names</span>(demo<span class="sc">$</span>NHDFlowline)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;COMID&quot;      &quot;StreamOrde&quot; &quot;Shape&quot;</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(demo<span class="sc">$</span>NHDFlowline), </span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>     <span class="at">lwd =</span> demo<span class="sc">$</span>NHDFlowline<span class="sc">$</span>StreamOrde<span class="sc">/</span><span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="make-standalone-basins" class="section level2">
<h2>Make Standalone Basins</h2>
<p>The NHDPlus data model has some shared identifiers that can span very
large distances. For example, the “Level Path Identifier” identifies an
entire river from headwater to outlet using the “hydrologic sequence
identifier” of the outlet. Similarly, the “Terminal Path Identifier”
identifies an entire basin using the hydrologic sequence identifier of
the terminal flowline (to the ocean or an inland sink). When creating
subsets of NHDPlus data, many times, these attributes can identify
flowlines that are not included in the subset. For most applications,
this is not a problem, but in some cases, it is advantageous to adjust
identifiers such that the subset appears to be a complete drainage basin
with a true terminal outlet. <code>make_standalone()</code> accomplishes
this task.</p>
<p>On a one by one basis, this may seam insignificant, but for workflows
that need to work with arbitrary subsets and start from basin outlets,
this functionality is useful. It has little impact on the data and is
applied by default.</p>
<p>The example below shows how the outlet is modified. As described in
the documentation os <code>make_standalone()</code> all related
attributes upstream are also fixed such that the network is intact for
further use.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">get_nhdplushr</span>(hr_data_dir, <span class="at">layers =</span> <span class="st">&quot;NHDFlowline&quot;</span>, </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                    <span class="at">min_size_sqkm =</span> <span class="dv">100</span>, <span class="at">check_terminals =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># Create a standalone basin with the results for comparison.</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>standalone_demo <span class="ot">&lt;-</span> <span class="fu">make_standalone</span>(demo<span class="sc">$</span>NHDFlowline)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>demo_outlet <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(demo<span class="sc">$</span>NHDFlowline, TotDASqKM <span class="sc">==</span> <span class="fu">max</span>(TotDASqKM)) </span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>standalone_demo_outlet <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(standalone_demo, TotDASqKM <span class="sc">==</span> <span class="fu">max</span>(TotDASqKM))</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>broken_outlet <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">st_drop_geometry</span>(demo_outlet), </span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                               Hydroseq, TerminalPa, TerminalFl, LevelPathI)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>fixed_outlet <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">st_drop_geometry</span>(standalone_demo_outlet), </span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>                              Hydroseq, TerminalPa, TerminalFl, LevelPathI)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">data.frame</span>(broken_outlet))</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt;         Hydroseq     TerminalPa TerminalFl     LevelPathI</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; 1 22001000000414 22000100000212          0 22000300045683</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">data.frame</span>(fixed_outlet))</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt;         Hydroseq     TerminalPa TerminalFl     LevelPathI</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; 1 22001000000414 22001000000414          1 22001000000414</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>(broken <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(demo<span class="sc">$</span>NHDFlowline, TerminalPa <span class="sc">==</span> demo_outlet<span class="sc">$</span>Hydroseq))</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 0 features and 57 fields</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  NAD83</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt; # A tibble: 0 × 58</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="co">#&gt; # ℹ 58 variables: Permanent_Identifier &lt;chr&gt;, FDate &lt;dttm&gt;, Resolution &lt;int&gt;,</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="co">#&gt; #   GNIS_ID &lt;chr&gt;, GNIS_Name &lt;chr&gt;, LENGTHKM &lt;dbl&gt;, REACHCODE &lt;chr&gt;,</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co">#&gt; #   FlowDir &lt;int&gt;, WBArea_Permanent_Identifier &lt;chr&gt;, FTYPE &lt;int&gt;, FCODE &lt;int&gt;,</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co">#&gt; #   MainPath &lt;int&gt;, InNetwork &lt;int&gt;, VisibilityFilter &lt;int&gt;,</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a><span class="co">#&gt; #   Shape_Length &lt;dbl&gt;, COMID &lt;dbl&gt;, VPUID &lt;chr&gt;, Enabled &lt;int&gt;,</span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a><span class="co">#&gt; #   Shape &lt;GEOMETRY [°]&gt;, StreamLeve &lt;int&gt;, StreamOrde &lt;int&gt;, StreamCalc &lt;int&gt;,</span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="co">#&gt; #   FromNode &lt;dbl&gt;, ToNode &lt;dbl&gt;, Hydroseq &lt;dbl&gt;, LevelPathI &lt;dbl&gt;, …</span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>(standalone <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(standalone_demo, TerminalPa <span class="sc">==</span> standalone_demo_outlet<span class="sc">$</span>Hydroseq))</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 5358 features and 57 fields</span></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a><span class="co">#&gt; Geometry type: MULTILINESTRING</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -90.68076 ymin: 41.27482 xmax: -88.1999 ymax: 43.74949</span></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  NAD83</span></span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5,358 × 58</span></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a><span class="co">#&gt;    Permanent_Identifier FDate               Resolution GNIS_ID  GNIS_Name       </span></span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a><span class="co">#&gt;  * &lt;chr&gt;                &lt;dttm&gt;                   &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;           </span></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a><span class="co">#&gt;  1 156038282            2012-03-19 01:32:25          2 00415503 Pecatonica River</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a><span class="co">#&gt;  2 155714162            2014-10-28 19:00:00          2 00424882 Fairfield Ditch…</span></span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a><span class="co">#&gt;  3 156035374            2012-03-19 01:35:08          2 01561947 Gordon Creek    </span></span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a><span class="co">#&gt;  4 145600320            2012-03-19 01:34:47          2 00416806 Rock Creek      </span></span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a><span class="co">#&gt;  5 155712981            2012-03-19 02:05:44          2 &lt;NA&gt;     &lt;NA&gt;            </span></span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a><span class="co">#&gt;  6 137417698            2012-03-18 13:07:31          2 01575030 Sugar River     </span></span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a><span class="co">#&gt;  7 156037500            2012-03-19 01:33:10          2 &lt;NA&gt;     &lt;NA&gt;            </span></span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a><span class="co">#&gt;  8 145599800            2012-03-19 01:34:47          2 00414599 North Fork Kent…</span></span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a><span class="co">#&gt;  9 143246785            2012-03-18 12:56:43          2 00416824 Rock River      </span></span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a><span class="co">#&gt; 10 155712415            2012-03-19 02:05:51          2 00424170 Willow Creek    </span></span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a><span class="co">#&gt; # ℹ 5,348 more rows</span></span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a><span class="co">#&gt; # ℹ 53 more variables: LENGTHKM &lt;dbl&gt;, REACHCODE &lt;chr&gt;, FlowDir &lt;int&gt;,</span></span>
<span id="cb10-56"><a href="#cb10-56" tabindex="-1"></a><span class="co">#&gt; #   WBArea_Permanent_Identifier &lt;chr&gt;, FTYPE &lt;int&gt;, FCODE &lt;int&gt;,</span></span>
<span id="cb10-57"><a href="#cb10-57" tabindex="-1"></a><span class="co">#&gt; #   MainPath &lt;int&gt;, InNetwork &lt;int&gt;, VisibilityFilter &lt;int&gt;,</span></span>
<span id="cb10-58"><a href="#cb10-58" tabindex="-1"></a><span class="co">#&gt; #   Shape_Length &lt;dbl&gt;, COMID &lt;dbl&gt;, VPUID &lt;chr&gt;, Enabled &lt;int&gt;,</span></span>
<span id="cb10-59"><a href="#cb10-59" tabindex="-1"></a><span class="co">#&gt; #   Shape &lt;MULTILINESTRING [°]&gt;, StreamLeve &lt;int&gt;, StreamOrde &lt;int&gt;,</span></span>
<span id="cb10-60"><a href="#cb10-60" tabindex="-1"></a><span class="co">#&gt; #   StreamCalc &lt;int&gt;, FromNode &lt;dbl&gt;, ToNode &lt;dbl&gt;, Hydroseq &lt;dbl&gt;, …</span></span>
<span id="cb10-61"><a href="#cb10-61" tabindex="-1"></a></span>
<span id="cb10-62"><a href="#cb10-62" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(standalone))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
